responseData = {"_id":"54340c00a37f31000046b5e7","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7","name":"Model Test","kind":"Collection","metakind":"Collection","order":2000,"parent":"54340aa0a37f31000046b5d8","uuid":"05f5c77c-28df-32f5-c836-fdb961332e2a","_tenant":"testtenant","__v":0,"visible":true,"sortorder":"-order","count":10,"assets":[{"_id":"54340c2ea37f31000046b5f3","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5f3","metakind":"Image","kind":"Image","name":"05","serving_url":"//lh4.ggpht.com/y4BbjykpSIXjau_Li2gts6WGq2kSThj7oJgpIrXD7M3wPMHs4i-iOOCeIW4I0nBINSw0B3jf-XrzYGOU0Bp64Xc","uuid":"1b09aa01-f244-c23c-f92c-63731014e5da","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:24.788Z","created":"2014-10-07T15:52:14.324Z","level":3,"id":"54340c2ea37f31000046b5f3"},{"_id":"54340c2ea37f31000046b5f1","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5f1","metakind":"Image","kind":"Image","name":"03","serving_url":"//lh6.ggpht.com/uNELlRGfi1beFLiP286ZN-O7KYLUD7oMBdheE6_c6SfNnQa-07AuF96vOPcgYxEoAU2LB_6Rlh0928WSJzPYKg","uuid":"68c7e34c-7a0a-adf3-ebdc-94cdadc5cee6","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:21.366Z","created":"2014-10-07T15:52:14.295Z","level":3,"id":"54340c2ea37f31000046b5f1"},{"_id":"54340c2ea37f31000046b5ef","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5ef","metakind":"Image","kind":"Image","name":"04","serving_url":"//lh5.ggpht.com/bH3qdz7G4DJjrHAFFpyz5U-71y9jUlrmQhOCU860cwE8idWOwDLsSXhLYsVaQ458V9BP4VbekBZJzkoKEkML","uuid":"f48c9ebf-ad52-bed7-aa74-b167f5e22d43","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:21.020Z","created":"2014-10-07T15:52:14.216Z","level":3,"id":"54340c2ea37f31000046b5ef"},{"_id":"54340c2da37f31000046b5e9","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2da37f31000046b5e9","metakind":"Image","kind":"Image","name":"01","serving_url":"//lh4.ggpht.com/CCOwGHhN8b0-n3kuo6TXOCNVg9yX3lCkIk1gkYBMY3cXNU8RTuVNnAuMqHi5BeBid1hF4HeKsZbJ97NC4Grx","uuid":"3823bfef-c1d6-b918-5722-6d810045c363","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:21.123Z","created":"2014-10-07T15:52:13.793Z","level":3,"id":"54340c2da37f31000046b5e9"},{"_id":"54340c2ea37f31000046b5f4","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5f4","metakind":"Image","kind":"Image","name":"06","serving_url":"//lh5.ggpht.com/sioh1a_koMab7EtVSnmeAWT3PH44q2_36jKL4F5s8rvJBGPcXvZvICg43Myaf86CAcrn_JmUkHF_znXPerc-","uuid":"9976f792-5644-2548-3ca6-cdcb8cee764f","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:21.278Z","created":"2014-10-07T15:52:14.351Z","level":3,"id":"54340c2ea37f31000046b5f4"},{"_id":"54340c2ea37f31000046b5f9","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5f9","metakind":"Image","kind":"Image","name":"09","serving_url":"//lh5.ggpht.com/02VykpDSEMKTtLEZRjmjg_sh1dNSW-tK_ElWJybionHUcAljkaWaDUP8PNyuzmI9sIeP96XSIKec38Ey_i6tyA","uuid":"4601e8b2-aec4-9bd1-d793-16044878cc7d","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:27.268Z","created":"2014-10-07T15:52:14.589Z","level":3,"id":"54340c2ea37f31000046b5f9"},{"_id":"54340c2ea37f31000046b5f7","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5f7","metakind":"Image","kind":"Image","name":"08","serving_url":"//lh4.ggpht.com/RA7W6JZ0m3FLP89e0wgqm9nX3uJBP67DoU-vW8M7UUfcN4XTmzJhKppzGViHXH595jiUXXwdaZTSW3CMtBgSy6s","uuid":"a9d0a059-25f0-1beb-66fb-9ca32bb426da","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:25.147Z","created":"2014-10-07T15:52:14.404Z","level":3,"id":"54340c2ea37f31000046b5f7"},{"_id":"54340c2ea37f31000046b5fb","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5fb","metakind":"Image","kind":"Image","name":"10","serving_url":"//lh3.ggpht.com/7lEwr7jiozjmLgQj03fyXgqfnPKq0L-NHsv2Hp57LMfU6pOQrQjlFF37bLqdPdAfuLLEu9hm6RApPPqm8RFw8Q","uuid":"04182ffb-6323-c0e7-7e54-204fe79301a0","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:27.969Z","created":"2014-10-07T15:52:14.639Z","level":3,"id":"54340c2ea37f31000046b5fb"},{"_id":"54340c2da37f31000046b5eb","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2da37f31000046b5eb","metakind":"Image","kind":"Image","name":"02","serving_url":"//lh4.ggpht.com/En4U9oSfkV5kRVZbYiwmfZHltETawBhr2nHCpp1hNiEzVomK8nts4c6rUvNw1AP8uLvqNGUvwoDALGWuspTf","uuid":"88de4645-f7f6-beb4-0f3e-5735a9a9413c","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:24.854Z","created":"2014-10-07T15:52:13.896Z","level":3,"id":"54340c2da37f31000046b5eb"},{"_id":"54340c2ea37f31000046b5ed","path":"54340aa0a37f31000046b5d8#54340c00a37f31000046b5e7#54340c2ea37f31000046b5ed","metakind":"Image","kind":"Image","name":"07","serving_url":"//lh3.ggpht.com/7xFeHgLs8lwlwLB37rQ3aZ9tqdlsSv28uS8Nfft7lMUVpsl6PoHFXq5ugKTMKUCxCqLQV0Ll2F-LcMk6JPes7w","uuid":"d3829f0a-a1f2-79f6-976e-4afc13adb8d8","order":11000,"parent":"54340c00a37f31000046b5e7","_tenant":"testtenant","__v":0,"resolution":"2666x2000","visible":true,"sortorder":"-order","count":null,"assets":[],"fields":{},"modified":"2014-10-07T15:52:24.508Z","created":"2014-10-07T15:52:14.176Z","level":3,"id":"54340c2ea37f31000046b5ed"}],"fields":{},"modified":"2014-10-07T15:52:39.955Z","created":"2014-10-07T15:51:28.818Z","level":2,"id":"54340c00a37f31000046b5e7"}
responseCollection = _.omit(responseData, 'assets')

describe("Unit: imagoModel", ->
  $rootScope   = {}
  $httpBackend = {}
  imagoModel   = {}

  # Mock Application to allow us to inject our own dependencies
  beforeEach ->
    module('imago.widgets.angular')

  beforeEach ->
    inject (_$rootScope_, _imagoModel_, _$httpBackend_) ->
      $rootScope   = _$rootScope_
      imagoModel   = _imagoModel_
      $httpBackend = _$httpBackend_

  describe 'getData invoked', ->

    beforeEach ->
      $httpBackend.when('POST', '/api/search').respond(responseData)

    it "Should return data", () ->
      imagoModel.getData('/test').then (response) ->

        expect(response[0]).toEqual(responseCollection)

      $rootScope.$digest()
      $httpBackend.flush()
      expect(imagoModel.data.length).toEqual(11)


  )




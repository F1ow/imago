var imagoImage;imagoImage=function(){function e(e,i,n){return{replace:!0,scope:!0,templateUrl:"imagoImage.html",controller:function(e){return e.status="loading",e.imageStyle={}},link:function(i,t,a){var s,r,o,l,g,u,d,c,m;u={visible:!1},c={},l={align:"center center",sizemode:"fit",hires:!0,responsive:!0,scale:1,lazy:!0,maxsize:2560};for(o in a)m=a[o],l[o]="true"===m||"false"===m?JSON.parse(m):m;return u.watch=i.$watch(a.imagoImage,function(){return function(e){return e?(a.watch||u.watch(),c=e,(null!=c?c.serving_url:void 0)?(c.fields.hasOwnProperty("crop")&&!a.align&&(l.align=c.fields.crop.value),c.fields.hasOwnProperty("sizemode")&&("default"===c.fields.sizemode.value||a.sizemode||(l.sizemode=c.fields.sizemode.value)),l.responsive&&"crop"===l.sizemode&&i.$on("resizelimit",function(){return s(),i.$digest()}),r()):void t.remove()):void 0}}(this)),r=function(){var a,s,r,o,u,d;return angular.isString(c.resolution)&&(r=c.resolution.split("x"),l.resolution={width:r[0],height:r[1]},l.assetRatio=r[0]/r[1]),"preloading"===i.status?console.log("tried to render during rendering!!"):(i.status="preloading",i.align=l.align,i.sizemode=l.sizemode,u=t[0].clientWidth,s=t[0].clientHeight,s&&(d=u/s),a=l.hires?Math.ceil(e.devicePixelRatio)||1:1,"crop"===l.sizemode&&s?o=Math.round(l.assetRatio<=d?Math.max(u,u/l.assetRatio):Math.max(s,s*l.assetRatio)):!s||l.autosize?(l.autosize=!0,o=Math.round(Math.max(u,u/l.assetRatio))):o=Math.round(l.assetRatio<=d?Math.max(s,s*l.assetRatio):Math.max(u,u/l.assetRatio)),o=parseInt(Math.min(o*a,l.maxsize),10),o===l.servingSize?void(i.status="loaded"):(l.servingSize=o,l.servingUrl=n.isBaseString(c.serving_url)?c.serving_url:""+c.serving_url+"=s"+o*l.scale,g()))},g=function(){var e;return l.lazy&&!u.visible?u.visibleFunc=i.$watch(a.visible,function(){return function(e){return e?(u.visible=!0,u.visibleFunc(),g()):void 0}}(this)):(e=angular.element("<img>"),e.on("load",function(){return"crop"===l.sizemode?i.imageStyle={backgroundImage:"url("+l.servingUrl+")",backgroundSize:s(),backgroundPosition:l.align}:i.servingUrl=l.servingUrl,i.status="loaded",i.$digest()}),e[0].src=l.servingUrl)},s=function(){var e,n,a;return n=t[0].clientWidth,e=t[0].clientHeight,e&&(a=n/e),"crop"===l.sizemode?i.imageStyle["background-size"]=l.assetRatio<a?"100% auto":"auto 100%":void 0},d=function(){var e;return"crop"===l.sizemode?e={backgroundImage:"url("+l.servingUrl+")",backgroundSize:s(),backgroundPosition:l.align}:void(i.servingUrl=l.servingUrl)},l.responsive&&i.$on("resizestop",function(){return i.status="loading",r()}),angular.element(e).on("orientationchange",r)}}}return e}(),angular.module("imago").directive("imagoImage",["$window","$log","imagoUtils",imagoImage]),angular.module("imago").run(["$templateCache",function(e){e.put("imagoImage.html",'<div in-view="visible = $inview" responsive-events="responsive-events" ng-style="elementStyle" ng-class="[status, align]" visible="visible" ng-switch="sizemode" class="imagoimage"><img ng-src="{{servingUrl}}" ng-style="imageStyle" ng-switch-when="fit" class="imagox23"/><div ng-style="imageStyle" ng-switch-when="crop" class="imagox23"></div><div class="loading"><div class="spin"></div><div class="spin2"></div></div></div>')}]);
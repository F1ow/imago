var imagoImage;imagoImage=function(){function e(e,i,t){return{replace:!0,scope:!0,templateUrl:"/imago/imagoImage.html",controller:function(e){return e.status="loading",e.imageStyle={}},link:function(i,a,n){var s,o,r,l,g,u,d,c,m;u={visible:!1},c={},l={align:"center center",sizemode:"fit",hires:!0,responsive:!0,scale:1,lazy:!0,maxsize:2560};for(r in n)m=n[r],l[r]="true"===m||"false"===m?JSON.parse(m):m;return u.watch=i.$watch(n.imagoImage,function(){return function(e){return e?(n.watch||u.watch(),c=e,(null!=c?c.serving_url:void 0)?(c.fields.hasOwnProperty("crop")&&!n.align&&(l.align=c.fields.crop.value),c.fields.hasOwnProperty("sizemode")&&("default"===c.fields.sizemode.value||n.sizemode||(l.sizemode=c.fields.sizemode.value)),l.responsive&&"crop"===l.sizemode&&i.$on("resizelimit",function(){return s(),i.$digest()}),o()):void a.remove()):void 0}}(this)),o=function(){var n,s,o,r,u,d;return angular.isString(c.resolution)&&(o=c.resolution.split("x"),l.resolution={width:o[0],height:o[1]},l.assetRatio=o[0]/o[1]),"preloading"===i.status?console.log("tried to render during rendering!!"):(i.status="preloading",i.align=l.align,i.sizemode=l.sizemode,u=a[0].clientWidth,s=a[0].clientHeight,s&&(d=u/s),n=l.hires?Math.ceil(e.devicePixelRatio)||1:1,"crop"===l.sizemode&&s?r=Math.round(l.assetRatio<=d?Math.max(u,u/l.assetRatio):Math.max(s,s*l.assetRatio)):s&&"height"!==l.autosize?u&&"width"!==l.autosize?r=Math.round(l.assetRatio<=d?Math.max(s,s*l.assetRatio):Math.max(u,u/l.assetRatio)):(l.autosize="width",r=Math.round(Math.max(s,s*l.assetRatio))):(l.autosize="height",r=Math.round(Math.max(u,u/l.assetRatio))),r=parseInt(Math.min(r*n,l.maxsize),10),r===l.servingSize?void(i.status="loaded"):(l.servingSize=r,l.servingUrl=t.isBaseString(c.serving_url)?c.serving_url:c.serving_url+"=s"+r*l.scale,g()))},g=function(){var e;return l.lazy&&!u.visible?u.visibleFunc=i.$watch(n.visible,function(){return function(e){return e?(u.visible=!0,u.visibleFunc(),g()):void 0}}(this)):(e=angular.element("<img>"),e.on("load",function(){return"crop"===l.sizemode?i.imageStyle={backgroundImage:"url("+l.servingUrl+")",backgroundSize:s(),backgroundPosition:l.align}:i.servingUrl=l.servingUrl,i.status="loaded",i.$digest()}),e[0].src=l.servingUrl)},s=function(){var e,t,n;return t=a[0].clientWidth,e=a[0].clientHeight,e&&(n=t/e),"crop"===l.sizemode?i.imageStyle["background-size"]=l.assetRatio<n?"100% auto":"auto 100%":void 0},d=function(){var e;return"crop"===l.sizemode?e={backgroundImage:"url("+l.servingUrl+")",backgroundSize:s(),backgroundPosition:l.align}:void(i.servingUrl=l.servingUrl)},l.responsive&&i.$on("resizestop",function(){return i.status="loading",o()}),angular.element(e).on("orientationchange",o)}}}return e}(),angular.module("imago").directive("imagoImage",["$window","$log","imagoUtils",imagoImage]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imagoImage.html",'<div in-view="visible = $inview" responsive-events="responsive-events" ng-style="elementStyle" ng-class="[status, align]" visible="visible" ng-switch="sizemode" class="imagoimage"><img ng-src="{{servingUrl}}" ng-style="imageStyle" ng-switch-when="fit" class="imagox23"/><div ng-style="imageStyle" ng-switch-when="crop" class="imagox23"></div><div class="loading"><div class="spin"></div><div class="spin2"></div></div></div>')}]);
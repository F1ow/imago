var imagoImage;imagoImage=function(){function e(e,i,a,t){return{replace:!0,scope:{visible:"=",data:"=imagoImage"},templateUrl:"/imago/imagoImage.html",controller:function(e,i,a){return e.status="loading",e.imageStyle={}},link:function(a,n,s){var o,r,l,g,u,d,c,v;d={},g={align:"center center",sizemode:"fit",hires:!0,responsive:!0,scale:1,lazy:!0,maxsize:2560};for(l in s)v=s[l],g[l]="true"===v||"false"===v?JSON.parse(v):v;return d.watch=a.$watch("data",function(e){return function(e){var i;if(e)return s.watch||d.watch(),(null!=(i=a.data)?i.serving_url:void 0)?(a.data.fields.hasOwnProperty("crop")&&!s.align&&(g.align=a.data.fields.crop.value),a.data.fields.hasOwnProperty("sizemode")&&("default"===a.data.fields.sizemode.value||s.sizemode||(g.sizemode=a.data.fields.sizemode.value)),g.responsive&&"crop"===g.sizemode&&a.$on("resizelimit",function(){return o(),a.$evalAsync()}),r()):void n.remove()}}(this)),r=function(){var i,s,o,r,l,d;return angular.isString(a.data.resolution)&&(o=a.data.resolution.split("x"),g.resolution={width:o[0],height:o[1]},g.assetRatio=o[0]/o[1]),"preloading"===a.status?console.log("tried to render during rendering!!"):(a.status="preloading",a.align=g.align,a.sizemode=g.sizemode,l=n[0].clientWidth,s=n[0].clientHeight,s&&(d=l/s),i=g.hires?Math.ceil(e.devicePixelRatio)||1:1,"crop"===g.sizemode&&s?r=Math.round(g.assetRatio<=d?Math.max(l,l/g.assetRatio):Math.max(s,s*g.assetRatio)):s&&"height"!==g.autosize?l&&"width"!==g.autosize?r=Math.round(g.assetRatio<=d?Math.max(s,s*g.assetRatio):Math.max(l,l/g.assetRatio)):(g.autosize="width",r=Math.round(Math.max(s,s*g.assetRatio))):(g.autosize="height",r=Math.round(Math.max(l,l/g.assetRatio))),r=parseInt(Math.min(r*i,g.maxsize),10),r===g.servingSize?void(a.status="loaded"):(g.servingSize=r,g.servingUrl=t.isBaseString(a.data.serving_url)?a.data.serving_url:a.data.serving_url+"=s"+r*g.scale,u()))},u=function(){var e;return g.lazy&&!a.visible?d.visibleFunc=a.$watch("visible",function(e){return function(e){return e?(d.visibleFunc(),u()):void 0}}(this)):(e=angular.element("<img>"),e.on("load",function(e){return"crop"===g.sizemode?a.imageStyle={backgroundImage:"url("+g.servingUrl+")",backgroundSize:o(),backgroundPosition:g.align}:a.servingUrl=g.servingUrl,a.status="loaded",a.$evalAsync()}),e[0].src=g.servingUrl)},o=function(){var e,i,t;return i=n[0].clientWidth,e=n[0].clientHeight,e&&(t=i/e),"crop"===g.sizemode?a.imageStyle["background-size"]=g.assetRatio<t?"100% auto":"auto 100%":void 0},c=function(){var e;return"crop"===g.sizemode?e={backgroundImage:"url("+g.servingUrl+")",backgroundSize:o(),backgroundPosition:g.align}:void(a.servingUrl=g.servingUrl)},g.responsive&&a.$on("resizestop",function(){return a.status="loading",r()}),a.$on("$stateChangeSuccess",function(){return i(function(){var e;return document.createEvent?(e=new Event("checkInView"),window.dispatchEvent(e)):(e=document.createEventObject(),e.eventType="checkInView",e.eventName="checkInView",window.fireEvent("on"+e.eventType,e))})}),angular.element(e).on("orientationchange",r)}}}return e}(),angular.module("imago").directive("imagoImage",["$window","$timeout","$log","imagoUtils",imagoImage]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imagoImage.html",'<div in-view="visible = $inview" responsive-events="responsive-events" ng-style="elementStyle" ng-class="[status, align]" visible="visible" ng-switch="sizemode" class="imagoimage"><img ng-src="{{servingUrl}}" ng-style="imageStyle" ng-switch-when="fit" class="imagox23"/><div ng-style="imageStyle" ng-switch-when="crop" class="imagox23"></div><div class="loading"><div class="spin"></div><div class="spin2"></div></div></div>')}]);
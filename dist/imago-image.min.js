var imagoImage;imagoImage=function(){function e(e,i,t){return{replace:!0,scope:!0,templateUrl:"/imago/imagoImage.html",controller:function(e){return e.status="loading",e.imageStyle={}},link:function(a,s,n){var o,r,l,g,u,d,c,m,v;d={visible:!1},m={},g={align:"center center",sizemode:"fit",hires:!0,responsive:!0,scale:1,lazy:!0,maxsize:2560};for(l in n)v=n[l],g[l]="true"===v||"false"===v?JSON.parse(v):v;return d.watch=a.$watch(n.imagoImage,function(){return function(e){return e?(n.watch||d.watch(),m=e,(null!=m?m.serving_url:void 0)?(m.fields.hasOwnProperty("crop")&&!n.align&&(g.align=m.fields.crop.value),m.fields.hasOwnProperty("sizemode")&&("default"===m.fields.sizemode.value||n.sizemode||(g.sizemode=m.fields.sizemode.value)),g.responsive&&"crop"===g.sizemode&&a.$on("resizelimit",function(){return o(),a.$digest()}),r()):void s.remove()):void 0}}(this)),r=function(){var n,o,r,l,d,c;return angular.isString(m.resolution)&&(r=m.resolution.split("x"),g.resolution={width:r[0],height:r[1]},g.assetRatio=r[0]/r[1]),"preloading"===a.status?console.log("tried to render during rendering!!"):(a.status="preloading",a.align=g.align,a.sizemode=g.sizemode,d=s[0].clientWidth,o=s[0].clientHeight,o&&(c=d/o),i.log("width, height, wrapperRatio, opts.assetRatio",d,o,c,g.assetRatio),n=g.hires?Math.ceil(e.devicePixelRatio)||1:1,"crop"===g.sizemode&&o?l=Math.round(g.assetRatio<=c?Math.max(d,d/g.assetRatio):Math.max(o,o*g.assetRatio)):o&&"height"!==g.autosize?d&&"width"!==g.autosize?l=Math.round(g.assetRatio<=c?Math.max(o,o*g.assetRatio):Math.max(d,d/g.assetRatio)):(g.autosize="width",l=Math.round(Math.max(o,o*g.assetRatio))):(g.autosize="height",l=Math.round(Math.max(d,d/g.assetRatio))),l=parseInt(Math.min(l*n,g.maxsize),10),l===g.servingSize?void(a.status="loaded"):(g.servingSize=l,g.servingUrl=t.isBaseString(m.serving_url)?m.serving_url:""+m.serving_url+"=s"+l*g.scale,u()))},u=function(){var e;return g.lazy&&!d.visible?d.visibleFunc=a.$watch(n.visible,function(){return function(e){return e?(d.visible=!0,d.visibleFunc(),u()):void 0}}(this)):(e=angular.element("<img>"),e.on("load",function(){return"crop"===g.sizemode?a.imageStyle={backgroundImage:"url("+g.servingUrl+")",backgroundSize:o(),backgroundPosition:g.align}:a.servingUrl=g.servingUrl,a.status="loaded",a.$digest()}),e[0].src=g.servingUrl)},o=function(){var e,i,t;return i=s[0].clientWidth,e=s[0].clientHeight,e&&(t=i/e),"crop"===g.sizemode?a.imageStyle["background-size"]=g.assetRatio<t?"100% auto":"auto 100%":void 0},c=function(){var e;return"crop"===g.sizemode?e={backgroundImage:"url("+g.servingUrl+")",backgroundSize:o(),backgroundPosition:g.align}:void(a.servingUrl=g.servingUrl)},g.responsive&&a.$on("resizestop",function(){return a.status="loading",r()}),angular.element(e).on("orientationchange",r)}}}return e}(),angular.module("imago").directive("imagoImage",["$window","$log","imagoUtils",imagoImage]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imagoImage.html",'<div in-view="visible = $inview" responsive-events="responsive-events" ng-style="elementStyle" ng-class="[status, align]" visible="visible" ng-switch="sizemode" class="imagoimage"><img ng-src="{{servingUrl}}" ng-style="imageStyle" ng-switch-when="fit" class="imagox23"/><div ng-style="imageStyle" ng-switch-when="crop" class="imagox23"></div><div class="loading"><div class="spin"></div><div class="spin2"></div></div></div>')}]);
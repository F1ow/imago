var imagoImage;imagoImage=function(){function e(e,i,n,t){return{replace:!0,scope:{visible:"=",source:"=imagoImage"},templateUrl:"/imago/imagoImage.html",controller:function(e,i,n){return e.status="loading",e.imageStyle={}},link:function(n,s,a){var o,r,l,u,c,g,d,v;g={},u={align:"center center",sizemode:"fit",hires:!0,responsive:!0,scale:1,lazy:!0,maxsize:2560};for(l in a)v=a[l],u[l]="true"===v||"false"===v?JSON.parse(v):v;return g.watch=n.$watch("source",function(e){return function(e){var i;if(e)return a.watch||g.watch(),(null!=(i=n.source)?i.serving_url:void 0)?(n.source.fields.hasOwnProperty("crop")&&!a.align&&(u.align=n.source.fields.crop.value),n.source.fields.hasOwnProperty("sizemode")&&("default"===n.source.fields.sizemode.value||a.sizemode||(u.sizemode=n.source.fields.sizemode.value)),u.responsive&&"crop"===u.sizemode&&n.$on("resizelimit",function(){return o(),n.$evalAsync()}),r()):void s.remove()}}(this)),r=function(){var i,a,o,r,l,g;return angular.isString(n.source.resolution)&&(o=n.source.resolution.split("x"),u.resolution={width:o[0],height:o[1]},u.assetRatio=o[0]/o[1]),"preloading"===n.status?console.log("tried to render during rendering!!"):(n.status="preloading",n.align=u.align,n.sizemode=u.sizemode,l=s[0].clientWidth,a=s[0].clientHeight,a&&(g=l/a),i=u.hires?Math.ceil(e.devicePixelRatio)||1:1,"crop"===u.sizemode&&a?r=Math.round(u.assetRatio<=g?Math.max(l,l/u.assetRatio):Math.max(a,a*u.assetRatio)):a&&"height"!==u.autosize?l&&"width"!==u.autosize?r=Math.round(u.assetRatio<=g?Math.max(a,a*u.assetRatio):Math.max(l,l/u.assetRatio)):(u.autosize="width",r=Math.round(Math.max(a,a*u.assetRatio))):(u.autosize="height",r=Math.round(Math.max(l,l/u.assetRatio))),r=parseInt(Math.min(r*i,u.maxsize),10),r===u.servingSize?void(n.status="loaded"):(u.servingSize=r,u.servingUrl=t.isBaseString(n.source.serving_url)?n.source.serving_url:n.source.serving_url+"=s"+r*u.scale,c()))},c=function(){var e;return u.lazy&&!n.visible?g.visibleFunc=n.$watch("visible",function(e){return function(e){return e?(g.visibleFunc(),c()):void 0}}(this)):(e=angular.element("<img>"),e.on("load",function(e){return"crop"===u.sizemode?n.imageStyle={backgroundImage:"url("+u.servingUrl+")",backgroundSize:o(),backgroundPosition:u.align}:n.servingUrl=u.servingUrl,n.status="loaded",n.$evalAsync()}),e[0].src=u.servingUrl)},o=function(){var e,i,t;return i=s[0].clientWidth,e=s[0].clientHeight,e&&(t=i/e),"crop"===u.sizemode?n.imageStyle["background-size"]=u.assetRatio<t?"100% auto":"auto 100%":void 0},d=function(){var e;return"crop"===u.sizemode?e={backgroundImage:"url("+u.servingUrl+")",backgroundSize:o(),backgroundPosition:u.align}:void(n.servingUrl=u.servingUrl)},u.responsive&&n.$on("resizestop",function(){return n.status="loading",n.source?r():void 0}),n.$on("$stateChangeSuccess",function(){return i(function(){var e;return document.createEvent?(e=new Event("checkInView"),window.dispatchEvent(e)):(e=document.createEventObject(),e.eventType="checkInView",e.eventName="checkInView",window.fireEvent("on"+e.eventType,e))})}),angular.element(e).on("orientationchange",r)}}}return e}(),angular.module("imago").directive("imagoImage",["$window","$timeout","$log","imagoUtils",imagoImage]),angular.module("imago").run(["$templateCache",function(e){e.put("/imago/imagoImage.html",'<div in-view="visible = $inview" responsive-events="responsive-events" ng-style="elementStyle" ng-class="[status, align]" visible="visible" ng-switch="sizemode" class="imagoimage"><img ng-src="{{servingUrl}}" ng-style="imageStyle" ng-switch-when="fit" class="imagox23"/><div ng-style="imageStyle" ng-switch-when="crop" class="imagox23"></div><div class="loading"><div class="spin"></div><div class="spin2"></div></div></div>')}]);
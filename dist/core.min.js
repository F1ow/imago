var App;App=function(){function e(){return["lodash"]}return e}(),angular.module("imago",new App);var lodash;lodash=angular.module("lodash",[]),lodash.factory("_",function(){return window._()});var imagoModel,__bind=function(e,t){return function(){return e.apply(t,arguments)}};imagoModel=function(){function e(e,t,a,n,i,r,o){this.$rootScope=e,this.$http=t,this.$location=a,this.$q=n,this.imagoUtils=i,this.imagoWorker=r,this.imagoSettings=o,this.prepareCreation=__bind(this.prepareCreation,this),this.isDuplicated=__bind(this.isDuplicated,this),this.batchChange=__bind(this.batchChange,this),this.reorder=__bind(this.reorder,this),this.reindexAll=__bind(this.reindexAll,this),this.reSort=__bind(this.reSort,this),this.paste=__bind(this.paste,this),this.move=__bind(this.move,this),this.copy=__bind(this.copy,this),this.trash=__bind(this.trash,this),this["delete"]=__bind(this["delete"],this),this.update=__bind(this.update,this),this.add=__bind(this.add,this),this.updateCount=__bind(this.updateCount,this),this.filterAssets=__bind(this.filterAssets,this),this.findIdx=__bind(this.findIdx,this),this.find=__bind(this.find,this),this.findByAttr=__bind(this.findByAttr,this),this.findParent=__bind(this.findParent,this),this.findChildren=__bind(this.findChildren,this),this.create=__bind(this.create,this),this.getData=__bind(this.getData,this),this.getLocalData=__bind(this.getLocalData,this),this.assets={get:function(e){return function(a){return t.get(""+e.imagoSettings.host+"/api/assets/"+a)}}(this),create:function(e){return function(a){return t.post(""+e.imagoSettings.host+"/api/assets",a)}}(this),update:function(e){return function(a){return t.put(""+e.imagoSettings.host+"/api/assets/"+a._id,a)}}(this),"delete":function(e){return function(a){return t["delete"](""+e.imagoSettings.host+"/api/assets/"+a)}}(this),trash:function(e){return function(a){return t.post(""+e.imagoSettings.host+"/api/assets/trash",a)}}(this),move:function(e){return function(a,n,i){var r;return r={src:n,dest:i,items:a},t.post(""+e.imagoSettings.host+"/api/assets/move",r)}}(this),copy:function(e){return function(a,n,i){var r;return r={src:n,dest:i,items:a},t.post(""+e.imagoSettings.host+"/api/assets/copy",r)}}(this),batch:function(e){return function(a){return t.put(""+e.imagoSettings.host+"/api/assets/update",{assets:a})}}(this)}}return e.prototype.data=[],e.prototype.currentCollection=void 0,e.prototype.search=function(e){var t;return t=_.map(e,this.formatQuery),this.$http.post(""+this.imagoSettings.host+"/api/search",angular.toJson(t))},e.prototype.getLocalData=function(e,t){var a,n,i,r,o;null==t&&(t={}),n=this.$q.defer();for(i in t)o=t[i],"localData"===i&&o===!1&&n.reject(e);for(i in e)o=e[i],"fts"===i?n.reject(e):"collection"===i?(e=this.imagoUtils.renameKey("collection","path",e),r=o):"kind"===i?e=this.imagoUtils.renameKey("kind","metakind",e):"path"===i&&(r=o);return r?(_.isString(r)?a=this.find({path:r}):_.isArray(r)&&(a=this.find({path:r[0]})),a?(a.assets=this.findChildren(a),a.count||a.assets.length?a.assets.length!==a.count?n.reject(e):(a.assets=this.filterAssets(a.assets,e),n.resolve(a)):n.resolve(a)):n.reject(e)):n.reject(e),n.promise},e.prototype.getData=function(e,t){var a,n,i,r,o,s;return null==t&&(t={}),n=this.$q.defer(),e=angular.copy(e),e||(e=this.$location.path()),_.isString(e)&&(e=[{path:e}]),e=this.imagoUtils.toArray(e),r=[],i=[],a=[],o=[],s=function(e){return function(){return i.push(e.search(o).then(function(t){var n,i,r,s,u;if(console.log("rejected query",o),t.data){for(s=t.data,u=[],i=0,r=s.length;r>i;i++)n=s[i],u.push(a.push(e.create(n)));return u}})),e.$q.all(i).then(function(){return n.resolve(a)})}}(this),_.forEach(e,function(e){return function(n){return r.push(e.getLocalData(n,t).then(function(t){var n;return t.assets?(n={assets:t.assets,order:t.sortorder,path:e.imagoSettings.sort_worker},i.push(e.imagoWorker.work(n).then(function(e){return t.assets=e.assets,a.push(t),a=_.flatten(a)}))):(a.push(t),a=_.flatten(a))},function(e){return o.push(e)}))}}(this)),this.$q.all(r).then(function(){return s()}),n.promise},e.prototype.formatQuery=function(e){var t,a,n,i,r,o,s,u,d;if(n={},_.isArray(e))for(r=0,s=e.length;s>r;r++){t=e[r];for(a in t)i=t[a],n[a]||(n[a]=[]),n[a].push(i)}else if(_.isPlainObject(e))for(a in e)i=e[a],n[a]=angular.isArray(i)?i:[i];else _.isString(e)&&(n.path=[e]);for(d=["page","pagesize"],o=0,u=d.length;u>o;o++)a=d[o],n.hasOwnProperty(a)&&(n[a]=n[a][0]);return n},e.prototype.create=function(e){var t,a,n,i,r;if(a=e,e.assets)for(r=e.assets,n=0,i=r.length;i>n;n++)t=r[n],t.metakind=t.metakind.toLowerCase(),t.kind=t.kind.toLowerCase(),t.base64=this.imagoUtils.isBaseString(t.serving_url)?!0:!1,this.find({_id:t._id})||this.data.push(t);return this.find({_id:a._id})||("Collection"===a.kind&&(a=_.omit(a,"assets")),this.data.push(a)),e},e.prototype.findChildren=function(e){return _.where(this.data,{parent:e._id})},e.prototype.findParent=function(e){return _.find(this.data,{_id:e.parent})},e.prototype.findByAttr=function(e){return null==e&&(e={}),_.where(this.data,e)},e.prototype.find=function(e){return null==e&&(e={}),_.find(this.data,e)},e.prototype.findIdx=function(e){return null==e&&(e={}),_.findIndex(this.data,e)},e.prototype.filterAssets=function(e,t){var a,n,i,r,o;if(t=_.omit(t,"path"),_.keys(t).length>0)for(a in t)for(i=t[a],r=0,o=i.length;o>r;r++)n=i[r],"path"!==a&&(e=_.filter(e,function(e){var t;if(null!=(t=e.fields)?t.hasOwnProperty(a):void 0){if(e.fields[a].value===n)return e}else if(e[a]===n)return e}));return e},e.prototype.updateCount=function(e,t){return e.count=e.count+t,this.update(e,{stream:!1})},e.prototype.add=function(e,t){var a,n,i,r;if(null==t&&(t={}),_.isUndefined(t.stream)&&(t.stream=!0),_.isUndefined(t.push)&&(t.push=!0),t.save)return n=this.$q.defer(),this.assets.create(e).then(function(e){return function(a){var i,r,o,s;if(t.push)for(s=a.data.data,r=0,o=s.length;o>r;r++)i=s[r],i.base64=e.imagoUtils.isBaseString(i.serving_url)?!0:!1,e.data.push(i);return n.resolve(a.data.data),t.stream?e.$rootScope.$emit("assets:add",a.data.data):void 0}}(this)),n.promise;if(t.push)for(i=0,r=e.length;r>i;i++)a=e[i],a.metakind=a.metakind.toLowerCase(),a.kind=a.kind.toLowerCase(),a.base64=this.imagoUtils.isBaseString(a.serving_url)?!0:!1,this.data.push(a);return t.stream?this.$rootScope.$emit("assets:add",e):void 0},e.prototype.update=function(e,t){var a,n,i,r,o,s,u,d;if(null==t&&(t={}),_.isUndefined(t.stream)&&(t.stream=!0),n=t.attribute?t.attribute:"_id",i=angular.copy(e),_.isPlainObject(i)){if(o={},o[n]=i[n],!i[n])return;i.assets&&delete i.assets,r=this.findIdx(o),-1!==r?this.data[r]=_.assign(this.data[r],i):this.data.push(i),t.save&&("processing"===i.status&&delete i.serving_url,this.assets.update(i))}else if(_.isArray(i)){for(s=0,u=i.length;u>s;s++)a=i[s],a.metakind=null!=(d=a.metakind)?d.toLowerCase():void 0,a.kind=null!=a?a.kind.toLowerCase():void 0,o={},o[n]=a[n],a.assets&&delete a.assets,r=this.findIdx(o),-1!==r?_.assign(this.data[r],a):this.data.push(a),"processing"===a.status&&delete a.serving_url;t.save&&this.assets.batch(i)}return t.stream?this.$rootScope.$emit("assets:update",i):void 0},e.prototype["delete"]=function(e,t){var a,n,i,r;if(null==t&&(t={}),e){for(n=this.$q.defer(),_.isUndefined(t.stream)&&(t.stream=!0),i=0,r=e.length;r>i;i++)a=e[i],this.data=_.reject(this.data,{_id:a._id}),t.save&&this.assets["delete"](a._id);return n.resolve(e),t.stream&&this.$rootScope.$emit("assets:delete",e),n.promise}},e.prototype.trash=function(e){var t,a,n,i,r;for(n=[],i=0,r=e.length;r>i;i++)t=e[i],a={_id:t._id},n.push(a);return this.assets.trash(n),this["delete"](e)},e.prototype.copy=function(e,t,a){return this.paste(e).then(function(e){return function(n){var i,r,o,s,u;for(o=[],s=0,u=n.length;u>s;s++)i=n[s],r={_id:i._id,order:i.order,name:i.name},o.push(r);return e.assets.copy(o,t,a).then(function(t){return"-order"===e.currentCollection.sortorder?e.update(t.data):(e.update(t.data,{stream:!1}),e.reSort(e.currentCollection))})}}(this))},e.prototype.move=function(e,t,a){return this.paste(e).then(function(e){return function(n){var i,r,o,s,u;for(o=[],s=0,u=n.length;u>s;s++)i=n[s],r={_id:i._id,order:i.order,name:i.name},o.push(r);return"-order"===e.currentCollection.sortorder?e.update(n):(e.update(n,{stream:!1}),e.reSort(e.currentCollection)),e.assets.move(o,t,a)}}(this))},e.prototype.paste=function(e,t){var a,n,i,r,o,s,u;for(null==t&&(t={}),_.isUndefined(t.checkdups)&&(t.checkdups=!0),r=this.$q.defer(),n=this.findChildren(this.currentCollection),i=function(e){return function(a){var i,r,o,s;if(i=e.$q.defer(),t.checkdups&&0!==_.where(n,{name:a.name}).length){for(o=1,r=!0,s=a.name;r;)a.name=""+s+"_"+o,o++,r=_.where(n,{name:a.name}).length>0?!0:!1;i.resolve(a)}else i.resolve(a);return i.promise}}(this),o=[],s=0,u=e.length;u>s;s++)a=e[s],o.push(i(a));return this.$q.all(o).then(function(){return function(e){return r.resolve(e)}}(this)),r.promise},e.prototype.reSort=function(e){var t;if(e.assets&&"-order"!==e.sortorder)return t=this.reindexAll(e.assets),this.update(t,{stream:!1,save:!0}),e.sortorder="-order",this.update(e,{save:!0})},e.prototype.reindexAll=function(e){var t,a,n,i,r,o,s;for(i=[],a=e.length,n=o=0,s=e.length;s>o;n=++o)t=e[n],t.order=(a-n)*this.imagoSettings.index,r={_id:t._id,order:t.order},i.push(r);return i},e.prototype.reorder=function(e,t,a,n){var i,r,o,s,u;return null==n&&(n={}),_.isUndefined(n.process)&&(n.process=!0),n.reverse?(i=e-a.length,o=t[i],s=t[e+1]?t[e+1]:{order:0},a=a.reverse()):n.process===!1?(o=t[e-1],s=t[e]?t[e]:{order:0}):(i=e+a.length,o=t[e-1]?t[e-1]:void 0,s=t[i]),u=o?(o.order-s.order)/(a.length+1):this.imagoSettings.index,r={minus:parseInt(u),order:parseInt(s.order+u)}},e.prototype.batchChange=function(e){var t,a,n,i,r,o,s,u,d;for(n=u=0,d=e.length;d>u;n=++u){if(t=e[n],r=this.find({_id:t._id}),!r)return;a={fields:r.fields,parent:r.parent},o=angular.copy(t);for(i in o)if(s=o[i],"fields"===i)for(i in o.fields)a.fields||(a.fields={}),a.fields[i]=o.fields[i];else a[i]=o[i];e[n]=a}return this.update(e,{save:!0})},e.prototype.isDuplicated=function(e,t,a){var n,i,r,o,s,u,d,l;if(null==a&&(a={}),_.isUndefined(a.rename)&&(a.rename=!1),i=this.$q.defer(),e.name||i.reject(e.name),u=this.imagoUtils.normalize(e.name),l=void 0,n=_.where(t,function(e){return function(t){var a;return t.name?(a=angular.copy(e.imagoUtils.normalize(t.name)),a===u):!1}}(this)),n.length)if(1===n.length&&n[0]._id===e._id&&i.resolve(!1),a.rename){for(s=1,r=!0,d=u;r;)u=""+d+"_"+s,s++,o=_.find(t,function(e){return function(t){var a;return a=angular.copy(e.imagoUtils.normalize(t.name)),a===u}}(this)),r=o?!0:!1;i.resolve(u)}else i.resolve(!0);else i.resolve(!1);return i.promise},e.prototype.prepareCreation=function(e,t,a,n){var i;return null==n&&(n=!1),i=this.$q.defer(),e.name||i.reject(e.name),this.isDuplicated(e,t.assets,{rename:n}).then(function(n){return function(r){var o,s;return r&&_.isBoolean(r)?i.resolve("duplicated"):(_.isString(r)&&(e.name=r),a?e.order=a:"-order"===t.sortorder?(o=t.assets,e.order=o.length?o[0].order+n.imagoSettings.index:n.imagoSettings.index):(t.assets.length?(s=n.reindexAll(t.assets),n.update(s,{save:!0}),e.order=s[0].order+n.imagoSettings.index):e.order=n.imagoSettings.index,t.sortorder="-order",n.update(t,{save:!0})),e.parent=t._id,i.resolve(e))}}(this)),i.promise},e}(),angular.module("imago").service("imagoModel",["$rootScope","$http","$location","$q","imagoUtils","imagoWorker","imagoSettings",imagoModel]);var imagoUtils;imagoUtils=function(){function e(){var e;return{KEYS:{16:"onShift",18:"onAlt",17:"onCommand",91:"onCommand",93:"onCommand",224:"onCommand",13:"onEnter",32:"onSpace",37:"onLeft",38:"onUp",39:"onRight",40:"onDown",46:"onDelete",8:"onBackspace",9:"onTab",188:"onComma",190:"onPeriod",27:"onEsc",186:"onColon",65:"onA",67:"onC",86:"onV",88:"onX",68:"onD",187:"onEqual",189:"onMinus"},SYMBOLS:{EUR:"&#128;",USD:"&#36;",SEK:"SEK",YEN:"&#165;",GBP:"&#163;",GENERIC:"&#164;"},CURRENCY_MAPPING:{"United Arab Emirates":"AED",Afghanistan:"AFN",Albania:"ALL",Armenia:"AMD",Angola:"AOA",Argentina:"ARS",Australia:"AUD",Aruba:"AWG",Azerbaijan:"AZN","Bosnia and Herzegovina":"BAM",Barbados:"BBD",Bangladesh:"BDT",Bulgaria:"BGN",Bahrain:"BHD",Burundi:"BIF",Bermuda:"BMD",Brunei:"BND",Bolivia:"BOB",Brazil:"BRL",Bahamas:"BSD",Bhutan:"BTN",Botswana:"BWP",Belarus:"BYR",Belize:"BZD",Canada:"CAD","Switzerland Franc":"CHF",Chile:"CLP",China:"CNY",Colombia:"COP","Costa Rica":"CRC","Cuba Convertible":"CUC","Cuba Peso":"CUP","Cape Verde":"CVE","Czech Republic":"CZK",Djibouti:"DJF",Denmark:"DKK","Dominican Republic":"DOP",Algeria:"DZD",Egypt:"EGP",Eritrea:"ERN",Ethiopia:"ETB",Autria:"EUR",Fiji:"FJD","United Kingdom":"GBP",Georgia:"GEL",Guernsey:"GGP",Ghana:"GHS",Gibraltar:"GIP",Gambia:"GMD",Guinea:"GNF",Guatemala:"GTQ",Guyana:"GYD","Hong Kong":"HKD",Honduras:"HNL",Croatia:"HRK",Haiti:"HTG",Hungary:"HUF",Indonesia:"IDR",Israel:"ILS","Isle of Man":"IMP",India:"INR",Iraq:"IQD",Iran:"IRR",Iceland:"ISK",Jersey:"JEP",Jamaica:"JMD",Jordan:"JOD",Japan:"JPY",Kenya:"KES",Kyrgyzstan:"KGS",Cambodia:"KHR",Comoros:"KMF","North Korea":"KPW","South Korea":"KRW",Kuwait:"KWD","Cayman Islands":"KYD",Kazakhstan:"KZT",Laos:"LAK",Lebanon:"LBP","Sri Lanka":"LKR",Liberia:"LRD",Lesotho:"LSL",Lithuania:"LTL",Latvia:"LVL",Libya:"LYD",Morocco:"MAD",Moldova:"MDL",Madagascar:"MGA",Macedonia:"MKD",Mongolia:"MNT",Macau:"MOP",Mauritania:"MRO",Mauritius:"MUR",Malawi:"MWK",Mexico:"MXN",Malaysia:"MYR",Mozambique:"MZN",Namibia:"NAD",Nigeria:"NGN",Nicaragua:"NIO",Norway:"NOK",Nepal:"NPR","New Zealand":"NZD",Oman:"OMR",Panama:"PAB",Peru:"PEN","Papua New Guinea":"PGK",Philippines:"PHP",Pakistan:"PKR",Poland:"PLN",Paraguay:"PYG",Qatar:"QAR",Romania:"RON",Serbia:"RSD",Russia:"RUB",Rwanda:"RWF","Saudi Arabia":"SAR","Solomon Islands":"SBD",Seychelles:"SCR",Sudan:"SDG",Sweden:"SEK",Singapore:"SGD","Saint Helena":"SHP",Suriname:"SRD","El Salvador":"SVC",Syria:"SYP",Swaziland:"SZL",Thailand:"THB",Tajikistan:"TJS",Turkmenistan:"TMT",Tunisia:"TND",Tonga:"TOP",Turkey:"TRY","Trinidad and Tobago":"TTD",Tuvalu:"TVD",Taiwan:"TWD",Tanzania:"TZS",Ukraine:"UAH",Uganda:"UGX","United States":"USD",Uruguay:"UYU",Uzbekistan:"UZS",Venezuela:"VEF",Vietnam:"VND",Vanuatu:"VUV",Samoa:"WST",Yemen:"YER","South Africa":"ZAR",Zambia:"ZMW",Zimbabwe:"ZWD",Austria:"EUR",Belgium:"EUR",Bulgaria:"EUR",Croatia:"EUR",Cyprus:"EUR","Czech Republic":"EUR",Denmark:"EUR",Estonia:"EUR",Finland:"EUR",France:"EUR",Germany:"EUR",Greece:"EUR",Hungary:"EUR",Ireland:"EUR",Italy:"EUR",Latvia:"EUR",Lithuania:"EUR",Luxembourg:"EUR",Malta:"EUR",Netherlands:"EUR",Poland:"EUR",Portugal:"EUR",Romania:"EUR",Slovakia:"EUR",Slovenia:"EUR",Spain:"EUR"},CODES:{Andorra:"AD","United Arab Emirates":"AE",Afghanistan:"AF","Antigua and Barbuda":"AG",Anguilla:"AI",Albania:"AL",Armenia:"AM",Angola:"AO",Antarctica:"AQ",Argentina:"AR","American Samoa":"AS",Austria:"AT",Australia:"AU",Aruba:"AW","Aland Islands":"AX",Azerbaijan:"AZ","Bosnia and Herzegovina":"BA",Barbados:"BB",Bangladesh:"BD",Belgium:"BE","Burkina Faso":"BF",Bulgaria:"BG",Bahrain:"BH",Burundi:"BI",Benin:"BJ","Saint Barthelemy":"BL",Bermuda:"BM",Brunei:"BN",Bolivia:"BO",Bonaire:"BQ",Brazil:"BR",Bahamas:"BS",Bhutan:"BT",Bouvet:"BV",Botswana:"BW",Belarus:"BY",Belize:"BZ",Canada:"CA","Cocos Islands":"CC","Democratic Republic of the Congo":"CD","Central African Republic":"CF","Republic of the Congo":"CG",Switzerland:"CH","Ivory Coast":"CI","Cook Islands":"CK",Chile:"CL",Cameroon:"CM",China:"CN",Colombia:"CO","Costa Rica":"CR",Cuba:"CU","Cape Verde":"CV",Curacao:"CW","Christmas Island":"CX",Cyprus:"CY","Czech Republic":"CZ",Germany:"DE",Djibouti:"DJ",Denmark:"DK",Dominica:"DM","Dominican Republic":"DO",Algeria:"DZ",Ecuador:"EC",Estonia:"EE",Egypt:"EG","Western Sahara":"EH",Eritrea:"ER",Spain:"ES",Ethiopia:"ET",Finland:"FI",Fiji:"FJ","Falkland Islands":"FK",Micronesia:"FM","Faroe Islands":"FO",France:"FR",Gabon:"GA","United Kingdom":"GB","Great Britain":"GB",Grenada:"GD",Georgia:"GE","French Guiana":"GF",Guernsey:"GG",Ghana:"GH",Gibraltar:"GI",Greenland:"GL",Gambia:"GM",Guinea:"GN",Guadeloupe:"GP","Equatorial Guinea":"GQ",Greece:"GR","South Georgia and the South Sandwich Islands":"GS",Guatemala:"GT",Guam:"GU","Guinea-Bissau":"GW",Guyana:"GY","Hong Kong":"HK","Heard Island and McDonald Islands":"HM",Honduras:"HN",Croatia:"HR",Haiti:"HT",Hungary:"HU",Indonesia:"ID",Ireland:"IE",Israel:"IL","Isle of Man":"IM",India:"IN","British Indian Ocean Territory":"IO",Iraq:"IQ",Iran:"IR",Iceland:"IS",Italy:"IT",Jersey:"JE",Jamaica:"JM",Jordan:"JO",Japan:"JP",Kenya:"KE",Kyrgyzstan:"KG",Cambodia:"KH",Kiribati:"KI",Comoros:"KM","Saint Kitts and Nevis":"KN","North Korea":"KP","South Korea":"KR",Kosovo:"XK",Kuwait:"KW","Cayman Islands":"KY",Kazakhstan:"KZ",Laos:"LA",Lebanon:"LB","Saint Lucia":"LC",Liechtenstein:"LI","Sri Lanka":"LK",Liberia:"LR",Lesotho:"LS",Lithuania:"LT",Luxembourg:"LU",Latvia:"LV",Libya:"LY",Morocco:"MA",Monaco:"MC",Moldova:"MD",Montenegro:"ME","Saint Martin":"MF",Madagascar:"MG","Marshall Islands":"MH",Macedonia:"MK",Mali:"ML",Myanmar:"MM",Mongolia:"MN",Macao:"MO","Northern Mariana Islands":"MP",Martinique:"MQ",Mauritania:"MR",Montserrat:"MS",Malta:"MT",Mauritius:"MU",Maldives:"MV",Malawi:"MW",Mexico:"MX",Malaysia:"MY",Mozambique:"MZ",Namibia:"NA","New Caledonia":"NC",Niger:"NE","Norfolk Island":"NF",Nigeria:"NG",Nicaragua:"NI",Netherlands:"NL",Norway:"NO",Nepal:"NP",Nauru:"NR",Niue:"NU","New Zealand":"NZ",Oman:"OM",Panama:"PA",Peru:"PE","French Polynesia":"PF","Papua New Guinea":"PG",Philippines:"PH",Pakistan:"PK",Poland:"PL","Saint Pierre and Miquelon":"PM",Pitcairn:"PN","Puerto Rico":"PR","Palestinian Territory":"PS",Portugal:"PT",Palau:"PW",Paraguay:"PY",Qatar:"QA",Reunion:"RE",Romania:"RO",Serbia:"RS",Russia:"RU",Rwanda:"RW","Saudi Arabia":"SA","Solomon Islands":"SB",Seychelles:"SC",Sudan:"SD","South Sudan":"SS",Sweden:"SE",Singapore:"SG","Saint Helena":"SH",Slovenia:"SI",Svalbard:"SJ",Slovakia:"SK","Sierra Leone":"SL","San Marino":"SM",Senegal:"SN",Somalia:"SO",Suriname:"SR","Sao Tome and Principe":"ST","El Salvador":"SV","Sint Maarten":"SX",Damascus:"SY",Swaziland:"SZ","Turks and Caicos Islands":"TC",Chad:"TD","French Southern Territories":"TF",Togo:"TG",Thailand:"TH",Tajikistan:"TJ",Tokelau:"TK","East Timor":"TL",Turkmenistan:"TM",Tunisia:"TN",Tonga:"TO",Turkey:"TR","Trinidad and Tobago":"TT",Tuvalu:"TV",Taiwan:"TW",Tanzania:"TZ",Ukraine:"UA",Uganda:"UG","United States Minor Outlying Islands":"UM","United States":"US",USA:"US","United States of America":"US",Uruguay:"UY",Uzbekistan:"UZ",Vatican:"VA","Saint Vincent and the Grenadines":"VC",Venezuela:"VE","British Virgin Islands":"VG","U.S. Virgin Islands":"VI",Vietnam:"VN",Vanuatu:"VU","Wallis and Futuna":"WF",Samoa:"WS",Yemen:"YE",Mayotte:"YT","South Africa":"ZA",Zambia:"ZM",Zimbabwe:"ZW","Serbia and Montenegro":"CS"},STATES:{AUSTRALIA:["ACT","NSW","NT","SA","TAS","QLD","VIC","WA"],CANADA:["AB","BC","MB","NB","NL","NS","ON","PE","QC","SK"],USA:["AL","AK","AS","AZ","CA","CO","CT","DE","DC","FM","FL","AR","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"]},CURRENCIES:["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYR","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","USS","UYI","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"],toType:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},requestAnimationFrame:function(){var e;return e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},function(t){return e.call(window,t)}}(),cookie:function(e,t){var a,n,i,r;if(!t){for(r=document.cookie.split(";"),n=0,i=r.length;i>n;n++)if(a=r[n],1===a.indexOf(e))return a.split("=")[1];return!1}return document.cookie=""+e+"="+t+"; path=/"},sha:function(){var e,t,a,n;for(a="",t="abcdefghijklmnopqrstuvwxyz0123456789",e=n=0;56>=n;e=++n)a+=t.charAt(Math.floor(Math.random()*t.length));return a},uuid:function(){var e;return e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},urlify:function(){return console.log("urlify")},queryfy:function(e){var t,a,n,i,r,o,s,u;for(i=[],u=e.split("+"),o=0,s=u.length;s>o;o++)a=u[o],a||(a="collection:/"),t=a.split(":"),n=t[0].toLowerCase(),r=decodeURIComponent(t[1]||""),t={},t[n]=r,i.push(t);return i},pluralize:function(e){return e+"s"},singularize:function(e){return e.replace(/s$/,"")},titleCase:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},normalize:function(e){var t,a,n;return t={"ä":"ae","ö":"oe","ü":"ue","&":"and","é":"e","ë":"e","ï":"i","è":"e","à":"a","ù":"u","ç":"c","ø":"o"},e=e.toLowerCase(),a=new RegExp(Object.keys(t).join("|"),"g"),n=e.trim().replace(a,function(e){return t[e]}).toLowerCase(),n.replace(/[',:;#]/g,"").replace(/[^\/\w]+/g,"-").replace(/\W?\/\W?/g,"/").replace(/^-|-$/g,"")},alphaNumSort:e=function(e,t){var a,n,i,r,o,s;for(r=function(e){var t,a,n,i,r,o,s;for(r=[],o=0,s=-1,i=0,t=void 0,a=void 0;t=(a=e.charAt(o++)).charCodeAt(0);)n=46===t||t>=48&&57>=t,n!==i&&(r[++s]="",i=n),r[s]+=a;return r},a=r(e),n=r(t),s=0;a[s]&&n[s];){if(a[s]!==n[s])return i=Number(a[s]),o=Number(n[s]),i===a[s]&&o===n[s]?i-o:a[s]>n[s]?1:-1;s++}return a.length-n.length},isiOS:function(){return!!navigator.userAgent.match(/iPad|iPhone|iPod/i)},isiPad:function(){return!!navigator.userAgent.match(/iPad/i)},isiPhone:function(){return!!navigator.userAgent.match(/iPhone/i)},isiPod:function(){return!!navigator.userAgent.match(/iPod/i)},isChrome:function(){return!!navigator.userAgent.match(/Chrome/i)},isIE:function(){return!!navigator.userAgent.match(/MSIE/i)},isFirefox:function(){return!!navigator.userAgent.match(/Firefox/i)},isSafari:function(){return!!navigator.userAgent.match(/Safari/i)&&!this.isChrome()},isEven:function(e){return this.isNumber(e)&&e%2===0},isOdd:function(e){return this.isNumber(e)&&e%2===1},isNumber:function(e){return e===parseFloat(e)},toFloat:function(e,t){var a,n;if(null==t&&(t=2),!t)return e;for(e=String(e).replace(/\D/g,""),a=e.slice(e.length-t);a.length<t;)a="0"+a;return n=e.slice(0,e.length-t)||"0",""+n+"."+a},toPrice:function(e,t){var a,n;return a=this.toFloat(e).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),n=this.getCurrencySymbol(t),""+n+" "+a},isEmail:function(e){var t;return t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,!!e.match(t)},getAssetKind:function(e){var t;return 0===e.indexOf("Collection-")?t="Collection":0===e.indexOf("Proxy-")?t="Proxy":0===e.indexOf("Order-")?t="Order":0===e.indexOf("Generic")?t="Generic":e.match(/[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}/)?t="Image":e.match(/[0-9a-z]{56}/)&&(t="Video"),t},getKeyName:function(e){return KEYS[e.which]},getURLParameter:function(e){var t,a;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search),null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))},inUsa:function(e){var t;return"usa"===(t=null!=e?e.toLowerCase():void 0)||"united states"===t||"united states of america"===t},replaceNewLines:function(e){return e.replace(/(\r\n\r\n|\r\n|\n|\r)/gm,"<br>")},getCurrencySymbol:function(e){return SYMBOLS[e]||SYMBOLS.GENERIC},getCurrency:function(e){return CURRENCY_MAPPING[e]},toArray:function(e){return angular.isArray(e)?e:[e]},getMeta:function(e,t){return e.fields[t]?e.fields[t].value:console.log("This asset does not contain a "+t+" attribute")},isBaseString:function(e){return null==e&&(e=""),!!e.match(this.isBaseRegex)},isBaseRegex:/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,renameKey:function(e,t,a){return a[t]=a[e],delete a[e],a}}}return e}(),angular.module("imago").factory("imagoUtils",[imagoUtils]);var imagoWorker,__bind=function(e,t){return function(){return e.apply(t,arguments)}};imagoWorker=function(){function e(e){this.$q=e,this.work=__bind(this.work,this),this.create=__bind(this.create,this)}return e.prototype.create=function(e){return new Worker(e)},e.prototype.work=function(e){var t,a;return t=this.$q.defer(),e&&e.path||t.reject("nodata"),a=this.create(e.path),a.addEventListener("message",function(){return function(e){return t.resolve(e.data),a.terminate()}}(this)),a.postMessage(e),t.promise},e}(),angular.module("imago").service("imagoWorker",["$q",imagoWorker]);var Meta;Meta=function(){function e(){return function(e,t){return e&&t&&e.fields[t]?e.fields[t].value.type?e.fields[t].value.value:e.fields[t].value:void 0}}return e}(),angular.module("imago").filter("meta",[Meta]);var imagoPage;imagoPage=function(){function e(e,t,a){var n;n="/",a.getData(n).then(function(t){return e.collection=t[0],e.assets=a.getChildren(t[0])})}return e}(),angular.module("imago").controller("imagoPage",["$scope","$state","imagoModel",imagoPage]);
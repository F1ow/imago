var App;App=function(){function a(){return["lodash"]}return a}(),angular.module("imago",new App);var lodash;lodash=angular.module("lodash",[]),lodash.factory("_",function(){return window._()});var imagoModel,__bind=function(a,e){return function(){return a.apply(e,arguments)}};imagoModel=function(){function a(a,e,n,t,i,r,o){this.$rootScope=a,this.$http=e,this.$location=n,this.$q=t,this.imagoUtils=i,this.imagoWorker=r,this.imagoSettings=o,this.prepareCreation=__bind(this.prepareCreation,this),this.isDuplicated=__bind(this.isDuplicated,this),this.batchChange=__bind(this.batchChange,this),this.reorder=__bind(this.reorder,this),this.reindexAll=__bind(this.reindexAll,this),this.reSort=__bind(this.reSort,this),this.paste=__bind(this.paste,this),this.move=__bind(this.move,this),this.copy=__bind(this.copy,this),this.trash=__bind(this.trash,this),this["delete"]=__bind(this["delete"],this),this.update=__bind(this.update,this),this.add=__bind(this.add,this),this.updateCount=__bind(this.updateCount,this),this.filterAssets=__bind(this.filterAssets,this),this.findIdx=__bind(this.findIdx,this),this.find=__bind(this.find,this),this.findByAttr=__bind(this.findByAttr,this),this.findParent=__bind(this.findParent,this),this.findChildren=__bind(this.findChildren,this),this.create=__bind(this.create,this),this.getData=__bind(this.getData,this),this.getLocalData=__bind(this.getLocalData,this),this.assets={get:function(a){return function(n){return e.get(""+a.imagoSettings.host+"/api/assets/"+n)}}(this),create:function(a){return function(n){return e.post(""+a.imagoSettings.host+"/api/assets",n)}}(this),update:function(a){return function(n){return e.put(""+a.imagoSettings.host+"/api/assets/"+n._id,n)}}(this),"delete":function(a){return function(n){return e["delete"](""+a.imagoSettings.host+"/api/assets/"+n)}}(this),trash:function(a){return function(n){return e.post(""+a.imagoSettings.host+"/api/assets/trash",n)}}(this),move:function(a){return function(n,t,i){var r;return r={src:t,dest:i,items:n},e.post(""+a.imagoSettings.host+"/api/assets/move",r)}}(this),copy:function(a){return function(n,t,i){var r;return r={src:t,dest:i,items:n},e.post(""+a.imagoSettings.host+"/api/assets/copy",r)}}(this),batch:function(a){return function(n){return e.put(""+a.imagoSettings.host+"/api/assets/update",{assets:n})}}(this)}}return a.prototype.data=[],a.prototype.currentCollection=void 0,a.prototype.search=function(a){var e;return e=_.map(a,this.formatQuery),this.$http.post(""+this.imagoSettings.host+"/api/search",angular.toJson(e))},a.prototype.getLocalData=function(a,e){var n,t,i,r,o;null==e&&(e={}),t=this.$q.defer();for(i in e)o=e[i],"localData"===i&&o===!1&&t.reject(a);for(i in a)o=a[i],"fts"===i?t.reject(a):"collection"===i?(a=this.imagoUtils.renameKey("collection","path",a),r=o):"kind"===i?a=this.imagoUtils.renameKey("kind","metakind",a):"path"===i&&(r=o);return r?(_.isString(r)?n=this.find({path:r}):_.isArray(r)&&(n=this.find({path:r[0]})),n?(n.assets=this.findChildren(n),n.count||n.assets.length?n.assets.length!==n.count?t.reject(a):(n.assets=this.filterAssets(n.assets,a),t.resolve(n)):t.resolve(n)):t.reject(a)):t.reject(a),t.promise},a.prototype.getData=function(a,e){var n,t,i,r,o,s;return null==e&&(e={}),t=this.$q.defer(),a=angular.copy(a),a||(a=this.$location.path()),_.isString(a)&&(a=[{path:a}]),a=this.imagoUtils.toArray(a),r=[],i=[],n=[],o=[],s=function(a){return function(){return i.push(a.search(o).then(function(e){var t,i,r,s,u;if(console.log("rejected query",o),e.data){for(s=e.data,u=[],i=0,r=s.length;r>i;i++)t=s[i],u.push(n.push(a.create(t)));return u}})),a.$q.all(i).then(function(){return t.resolve(n)})}}(this),_.forEach(a,function(a){return function(t){return r.push(a.getLocalData(t,e).then(function(e){var t;return e.assets?(t={assets:e.assets,order:e.sortorder,path:a.imagoSettings.sort_worker},i.push(a.imagoWorker.work(t).then(function(a){return e.assets=a.assets,n.push(e),n=_.flatten(n)}))):(n.push(e),n=_.flatten(n))},function(a){return o.push(a)}))}}(this)),this.$q.all(r).then(function(){return s()}),t.promise},a.prototype.formatQuery=function(a){var e,n,t,i,r,o,s,u,l;if(t={},_.isArray(a))for(r=0,s=a.length;s>r;r++){e=a[r];for(n in e)i=e[n],t[n]||(t[n]=[]),t[n].push(i)}else if(_.isPlainObject(a))for(n in a)i=a[n],t[n]=angular.isArray(i)?i:[i];else _.isString(a)&&(t.path=[a]);for(l=["page","pagesize"],o=0,u=l.length;u>o;o++)n=l[o],t.hasOwnProperty(n)&&(t[n]=t[n][0]);return t},a.prototype.create=function(a){var e,n,t,i,r;if(n=a,a.assets)for(r=a.assets,t=0,i=r.length;i>t;t++)e=r[t],e.base64=this.imagoUtils.isBaseString(e.serving_url)?!0:!1,this.find({_id:e._id})||this.data.push(e);return this.find({_id:n._id})||("Collection"===n.kind&&(n=_.omit(n,"assets")),this.data.push(n)),a},a.prototype.findChildren=function(a){return _.filter(this.data,{parent:a._id})},a.prototype.findParent=function(a){return _.find(this.data,{_id:a.parent})},a.prototype.findByAttr=function(a){return null==a&&(a={}),_.filter(this.data,a)},a.prototype.find=function(a){return null==a&&(a={}),_.find(this.data,a)},a.prototype.findIdx=function(a){return null==a&&(a={}),_.findIndex(this.data,a)},a.prototype.filterAssets=function(a,e){var n,t,i,r,o;if(e=_.omit(e,"path"),_.keys(e).length>0)for(n in e)for(i=e[n],r=0,o=i.length;o>r;r++)t=i[r],"path"!==n&&(a=_.filter(a,function(a){var e;if(null!=(e=a.fields)?e.hasOwnProperty(n):void 0){if(a.fields[n].value===t)return a}else if(a[n]===t)return a}));return a},a.prototype.updateCount=function(a,e){return a.count=a.count+e,this.update(a,{stream:!1})},a.prototype.add=function(a,e){var n,t,i,r;if(null==e&&(e={}),_.isUndefined(e.stream)&&(e.stream=!0),_.isUndefined(e.push)&&(e.push=!0),e.save)return t=this.$q.defer(),this.assets.create(a).then(function(a){return function(n){var i,r,o,s;if(e.push)for(s=n.data.data,r=0,o=s.length;o>r;r++)i=s[r],i.base64=a.imagoUtils.isBaseString(i.serving_url)?!0:!1,a.data.push(i);return t.resolve(n.data.data),e.stream?a.$rootScope.$emit("assets:add",n.data.data):void 0}}(this)),t.promise;if(e.push)for(i=0,r=a.length;r>i;i++)n=a[i],n.base64=this.imagoUtils.isBaseString(n.serving_url)?!0:!1,this.data.push(n);return e.stream?this.$rootScope.$emit("assets:add",a):void 0},a.prototype.update=function(a,e){var n,t,i,r,o,s,u;if(null==e&&(e={}),_.isUndefined(e.stream)&&(e.stream=!0),t=e.attribute?e.attribute:"_id",i=angular.copy(a),_.isPlainObject(i)){if(o={},o[t]=i[t],!i[t])return;i.assets&&delete i.assets,r=this.findIdx(o),-1!==r?this.data[r]=_.assign(this.data[r],i):this.data.push(i),e.save&&("processing"===i.status&&delete i.serving_url,this.assets.update(i))}else if(_.isArray(i)){for(s=0,u=i.length;u>s;s++)n=i[s],o={},o[t]=n[t],n.assets&&delete n.assets,r=this.findIdx(o),-1!==r?_.assign(this.data[r],n):this.data.push(n),"processing"===n.status&&delete n.serving_url;e.save&&this.assets.batch(i)}return e.stream?this.$rootScope.$emit("assets:update",i):void 0},a.prototype["delete"]=function(a,e){var n,t,i,r;if(null==e&&(e={}),a){for(t=this.$q.defer(),_.isUndefined(e.stream)&&(e.stream=!0),i=0,r=a.length;r>i;i++)n=a[i],this.data=_.reject(this.data,{_id:n._id}),e.save&&this.assets["delete"](n._id);return t.resolve(a),e.stream&&this.$rootScope.$emit("assets:delete",a),t.promise}},a.prototype.trash=function(a){var e,n,t,i,r;for(t=[],i=0,r=a.length;r>i;i++)e=a[i],n={_id:e._id},t.push(n);return this.assets.trash(t),this["delete"](a)},a.prototype.copy=function(a,e,n){return this.paste(a).then(function(a){return function(t){var i,r,o,s,u;for(o=[],s=0,u=t.length;u>s;s++)i=t[s],r={_id:i._id,order:i.order,name:i.name},o.push(r);return a.assets.copy(o,e,n).then(function(e){return"-order"===a.currentCollection.sortorder?a.update(e.data):(a.update(e.data,{stream:!1}),a.reSort(a.currentCollection))})}}(this))},a.prototype.move=function(a,e,n){return this.paste(a).then(function(a){return function(t){var i,r,o,s,u;for(o=[],s=0,u=t.length;u>s;s++)i=t[s],r={_id:i._id,order:i.order,name:i.name},o.push(r);return"-order"===a.currentCollection.sortorder?a.update(t):(a.update(t,{stream:!1}),a.reSort(a.currentCollection)),a.assets.move(o,e,n)}}(this))},a.prototype.paste=function(a,e){var n,t,i,r,o,s,u;for(null==e&&(e={}),_.isUndefined(e.checkdups)&&(e.checkdups=!0),r=this.$q.defer(),t=this.findChildren(this.currentCollection),i=function(a){return function(n){var i,r,o,s;if(i=a.$q.defer(),e.checkdups&&0!==_.filter(t,{name:n.name}).length){for(o=1,r=!0,s=n.name;r;)n.name=""+s+"_"+o,o++,r=_.filter(t,{name:n.name}).length>0?!0:!1;i.resolve(n)}else i.resolve(n);return i.promise}}(this),o=[],s=0,u=a.length;u>s;s++)n=a[s],o.push(i(n));return this.$q.all(o).then(function(){return function(a){return r.resolve(a)}}(this)),r.promise},a.prototype.reSort=function(a){var e;if(a.assets&&"-order"!==a.sortorder)return e=this.reindexAll(a.assets),this.update(e,{stream:!1,save:!0}),a.sortorder="-order",this.update(a,{save:!0})},a.prototype.reindexAll=function(a){var e,n,t,i,r,o,s;for(i=[],n=a.length,t=o=0,s=a.length;s>o;t=++o)e=a[t],e.order=(n-t)*this.imagoSettings.index,r={_id:e._id,order:e.order},i.push(r);return i},a.prototype.reorder=function(a,e,n,t){var i,r,o,s,u;return null==t&&(t={}),_.isUndefined(t.process)&&(t.process=!0),t.reverse?(i=a-n.length,o=e[i],s=e[a+1]?e[a+1]:{order:0},n=n.reverse()):t.process===!1?(o=e[a-1],s=e[a]?e[a]:{order:0}):(i=a+n.length,o=e[a-1]?e[a-1]:void 0,s=e[i]),u=o?(o.order-s.order)/(n.length+1):this.imagoSettings.index,r={minus:parseInt(u),order:parseInt(s.order+u)}},a.prototype.batchChange=function(a){var e,n,t,i,r,o,s,u,l;for(t=u=0,l=a.length;l>u;t=++u){if(e=a[t],r=this.find({_id:e._id}),!r)return;n={fields:r.fields,parent:r.parent},o=angular.copy(e);for(i in o)if(s=o[i],"fields"===i)for(i in o.fields)n.fields||(n.fields={}),n.fields[i]=o.fields[i];else n[i]=o[i];a[t]=n}return this.update(a,{save:!0})},a.prototype.isDuplicated=function(a,e,n){var t,i,r,o,s,u,l,d;if(null==n&&(n={}),_.isUndefined(n.rename)&&(n.rename=!1),i=this.$q.defer(),a.name||i.reject(a.name),u=this.imagoUtils.normalize(a.name),d=void 0,t=_.filter(e,function(a){return function(e){var n;return e.name?(n=angular.copy(a.imagoUtils.normalize(e.name)),n===u):!1}}(this)),t.length)if(1===t.length&&t[0]._id===a._id&&i.resolve(!1),n.rename){for(s=1,r=!0,l=u;r;)u=""+l+"_"+s,s++,o=_.find(e,function(a){return function(e){var n;return n=angular.copy(a.imagoUtils.normalize(e.name)),n===u}}(this)),r=o?!0:!1;i.resolve(u)}else i.resolve(!0);else i.resolve(!1);return i.promise},a.prototype.prepareCreation=function(a,e,n,t){var i;return null==t&&(t=!1),i=this.$q.defer(),a.name||i.reject(a.name),this.isDuplicated(a,e.assets,{rename:t}).then(function(t){return function(r){var o,s;return r&&_.isBoolean(r)?i.resolve("duplicated"):(_.isString(r)&&(a.name=r),n?a.order=n:"-order"===e.sortorder?(o=e.assets,a.order=o.length?o[0].order+t.imagoSettings.index:t.imagoSettings.index):(e.assets.length?(s=t.reindexAll(e.assets),t.update(s,{save:!0}),a.order=s[0].order+t.imagoSettings.index):a.order=t.imagoSettings.index,e.sortorder="-order",t.update(e,{save:!0})),a.parent=e._id,i.resolve(a))}}(this)),i.promise},a}(),angular.module("imago").service("imagoModel",["$rootScope","$http","$location","$q","imagoUtils","imagoWorker","imagoSettings",imagoModel]);var imagoUtils;imagoUtils=function(){function a(){var a;return{KEYS:{16:"onShift",18:"onAlt",17:"onCommand",91:"onCommand",93:"onCommand",224:"onCommand",13:"onEnter",32:"onSpace",37:"onLeft",38:"onUp",39:"onRight",40:"onDown",46:"onDelete",8:"onBackspace",9:"onTab",188:"onComma",190:"onPeriod",27:"onEsc",186:"onColon",65:"onA",67:"onC",86:"onV",88:"onX",68:"onD",187:"onEqual",189:"onMinus"},SYMBOLS:{EUR:"€",USD:"$",SEK:"SEK",YEN:"¥",GBP:"£",GENERIC:"¤",CHF:"CHF",NOK:"NOK"},CURRENCY_MAPPING:{"United Arab Emirates":"AED",Afghanistan:"AFN",Albania:"ALL",Armenia:"AMD",Angola:"AOA",Argentina:"ARS",Australia:"AUD",Aruba:"AWG",Azerbaijan:"AZN","Bosnia and Herzegovina":"BAM",Barbados:"BBD",Bangladesh:"BDT",Bulgaria:"BGN",Bahrain:"BHD",Burundi:"BIF",Bermuda:"BMD",Brunei:"BND",Bolivia:"BOB",Brazil:"BRL",Bahamas:"BSD",Bhutan:"BTN",Botswana:"BWP",Belarus:"BYR",Belize:"BZD",Canada:"CAD","Switzerland Franc":"CHF",Chile:"CLP",China:"CNY",Colombia:"COP","Costa Rica":"CRC","Cuba Convertible":"CUC","Cuba Peso":"CUP","Cape Verde":"CVE","Czech Republic":"CZK",Djibouti:"DJF",Denmark:"DKK","Dominican Republic":"DOP",Algeria:"DZD",Egypt:"EGP",Eritrea:"ERN",Ethiopia:"ETB",Autria:"EUR",Fiji:"FJD","United Kingdom":"GBP",Georgia:"GEL",Guernsey:"GGP",Ghana:"GHS",Gibraltar:"GIP",Gambia:"GMD",Guinea:"GNF",Guatemala:"GTQ",Guyana:"GYD","Hong Kong":"HKD",Honduras:"HNL",Croatia:"HRK",Haiti:"HTG",Hungary:"HUF",Indonesia:"IDR",Israel:"ILS","Isle of Man":"IMP",India:"INR",Iraq:"IQD",Iran:"IRR",Iceland:"ISK",Jersey:"JEP",Jamaica:"JMD",Jordan:"JOD",Japan:"JPY",Kenya:"KES",Kyrgyzstan:"KGS",Cambodia:"KHR",Comoros:"KMF","North Korea":"KPW","South Korea":"KRW",Kuwait:"KWD","Cayman Islands":"KYD",Kazakhstan:"KZT",Laos:"LAK",Lebanon:"LBP","Sri Lanka":"LKR",Liberia:"LRD",Lesotho:"LSL",Lithuania:"LTL",Latvia:"LVL",Libya:"LYD",Morocco:"MAD",Moldova:"MDL",Madagascar:"MGA",Macedonia:"MKD",Mongolia:"MNT",Macau:"MOP",Mauritania:"MRO",Mauritius:"MUR",Malawi:"MWK",Mexico:"MXN",Malaysia:"MYR",Mozambique:"MZN",Namibia:"NAD",Nigeria:"NGN",Nicaragua:"NIO",Norway:"NOK",Nepal:"NPR","New Zealand":"NZD",Oman:"OMR",Panama:"PAB",Peru:"PEN","Papua New Guinea":"PGK",Philippines:"PHP",Pakistan:"PKR",Poland:"PLN",Paraguay:"PYG",Qatar:"QAR",Romania:"RON",Serbia:"RSD",Russia:"RUB",Rwanda:"RWF","Saudi Arabia":"SAR","Solomon Islands":"SBD",Seychelles:"SCR",Sudan:"SDG",Sweden:"SEK",Singapore:"SGD","Saint Helena":"SHP",Suriname:"SRD","El Salvador":"SVC",Syria:"SYP",Swaziland:"SZL",Thailand:"THB",Tajikistan:"TJS",Turkmenistan:"TMT",Tunisia:"TND",Tonga:"TOP",Turkey:"TRY","Trinidad and Tobago":"TTD",Tuvalu:"TVD",Taiwan:"TWD",Tanzania:"TZS",Ukraine:"UAH",Uganda:"UGX","United States":"USD",Uruguay:"UYU",Uzbekistan:"UZS",Venezuela:"VEF",Vietnam:"VND",Vanuatu:"VUV",Samoa:"WST",Yemen:"YER","South Africa":"ZAR",Zambia:"ZMW",Zimbabwe:"ZWD",Austria:"EUR",Belgium:"EUR",Bulgaria:"EUR",Croatia:"EUR",Cyprus:"EUR","Czech Republic":"EUR",Denmark:"EUR",Estonia:"EUR",Finland:"EUR",France:"EUR",Germany:"EUR",Greece:"EUR",Hungary:"EUR",Ireland:"EUR",Italy:"EUR",Latvia:"EUR",Lithuania:"EUR",Luxembourg:"EUR",Malta:"EUR",Netherlands:"EUR",Poland:"EUR",Portugal:"EUR",Romania:"EUR",Slovakia:"EUR",Slovenia:"EUR",Spain:"EUR"},CODES:{Andorra:"AD","United Arab Emirates":"AE",Afghanistan:"AF","Antigua and Barbuda":"AG",Anguilla:"AI",Albania:"AL",Armenia:"AM",Angola:"AO",Antarctica:"AQ",Argentina:"AR","American Samoa":"AS",Austria:"AT",Australia:"AU",Aruba:"AW","Aland Islands":"AX",Azerbaijan:"AZ","Bosnia and Herzegovina":"BA",Barbados:"BB",Bangladesh:"BD",Belgium:"BE","Burkina Faso":"BF",Bulgaria:"BG",Bahrain:"BH",Burundi:"BI",Benin:"BJ","Saint Barthelemy":"BL",Bermuda:"BM",Brunei:"BN",Bolivia:"BO",Bonaire:"BQ",Brazil:"BR",Bahamas:"BS",Bhutan:"BT",Bouvet:"BV",Botswana:"BW",Belarus:"BY",Belize:"BZ",Canada:"CA","Cocos Islands":"CC","Democratic Republic of the Congo":"CD","Central African Republic":"CF","Republic of the Congo":"CG",Switzerland:"CH","Ivory Coast":"CI","Cook Islands":"CK",Chile:"CL",Cameroon:"CM",China:"CN",Colombia:"CO","Costa Rica":"CR",Cuba:"CU","Cape Verde":"CV",Curacao:"CW","Christmas Island":"CX",Cyprus:"CY","Czech Republic":"CZ",Germany:"DE",Djibouti:"DJ",Denmark:"DK",Dominica:"DM","Dominican Republic":"DO",Algeria:"DZ",Ecuador:"EC",Estonia:"EE",Egypt:"EG","Western Sahara":"EH",Eritrea:"ER",Spain:"ES",Ethiopia:"ET",Finland:"FI",Fiji:"FJ","Falkland Islands":"FK",Micronesia:"FM","Faroe Islands":"FO",France:"FR",Gabon:"GA","United Kingdom":"GB","Great Britain":"GB",Grenada:"GD",Georgia:"GE","French Guiana":"GF",Guernsey:"GG",Ghana:"GH",Gibraltar:"GI",Greenland:"GL",Gambia:"GM",Guinea:"GN",Guadeloupe:"GP","Equatorial Guinea":"GQ",Greece:"GR","South Georgia and the South Sandwich Islands":"GS",Guatemala:"GT",Guam:"GU","Guinea-Bissau":"GW",Guyana:"GY","Hong Kong":"HK","Heard Island and McDonald Islands":"HM",Honduras:"HN",Croatia:"HR",Haiti:"HT",Hungary:"HU",Indonesia:"ID",Ireland:"IE",Israel:"IL","Isle of Man":"IM",India:"IN","British Indian Ocean Territory":"IO",Iraq:"IQ",Iran:"IR",Iceland:"IS",Italy:"IT",Jersey:"JE",Jamaica:"JM",Jordan:"JO",Japan:"JP",Kenya:"KE",Kyrgyzstan:"KG",Cambodia:"KH",Kiribati:"KI",Comoros:"KM","Saint Kitts and Nevis":"KN","North Korea":"KP","South Korea":"KR",Kosovo:"XK",Kuwait:"KW","Cayman Islands":"KY",Kazakhstan:"KZ",Laos:"LA",Lebanon:"LB","Saint Lucia":"LC",Liechtenstein:"LI","Sri Lanka":"LK",Liberia:"LR",Lesotho:"LS",Lithuania:"LT",Luxembourg:"LU",Latvia:"LV",Libya:"LY",Morocco:"MA",Monaco:"MC",Moldova:"MD",Montenegro:"ME","Saint Martin":"MF",Madagascar:"MG","Marshall Islands":"MH",Macedonia:"MK",Mali:"ML",Myanmar:"MM",Mongolia:"MN",Macao:"MO","Northern Mariana Islands":"MP",Martinique:"MQ",Mauritania:"MR",Montserrat:"MS",Malta:"MT",Mauritius:"MU",Maldives:"MV",Malawi:"MW",Mexico:"MX",Malaysia:"MY",Mozambique:"MZ",Namibia:"NA","New Caledonia":"NC",Niger:"NE","Norfolk Island":"NF",Nigeria:"NG",Nicaragua:"NI",Netherlands:"NL",Norway:"NO",Nepal:"NP",Nauru:"NR",Niue:"NU","New Zealand":"NZ",Oman:"OM",Panama:"PA",Peru:"PE","French Polynesia":"PF","Papua New Guinea":"PG",Philippines:"PH",Pakistan:"PK",Poland:"PL","Saint Pierre and Miquelon":"PM",Pitcairn:"PN","Puerto Rico":"PR","Palestinian Territory":"PS",Portugal:"PT",Palau:"PW",Paraguay:"PY",Qatar:"QA",Reunion:"RE",Romania:"RO",Serbia:"RS",Russia:"RU",Rwanda:"RW","Saudi Arabia":"SA","Solomon Islands":"SB",Seychelles:"SC",Sudan:"SD","South Sudan":"SS",Sweden:"SE",Singapore:"SG","Saint Helena":"SH",Slovenia:"SI",Svalbard:"SJ",Slovakia:"SK","Sierra Leone":"SL","San Marino":"SM",Senegal:"SN",Somalia:"SO",Suriname:"SR","Sao Tome and Principe":"ST","El Salvador":"SV","Sint Maarten":"SX",Damascus:"SY",Swaziland:"SZ","Turks and Caicos Islands":"TC",Chad:"TD","French Southern Territories":"TF",Togo:"TG",Thailand:"TH",Tajikistan:"TJ",Tokelau:"TK","East Timor":"TL",Turkmenistan:"TM",Tunisia:"TN",Tonga:"TO",Turkey:"TR","Trinidad and Tobago":"TT",Tuvalu:"TV",Taiwan:"TW",Tanzania:"TZ",Ukraine:"UA",Uganda:"UG","United States Minor Outlying Islands":"UM","United States":"US",USA:"US","United States of America":"US",Uruguay:"UY",Uzbekistan:"UZ",Vatican:"VA","Saint Vincent and the Grenadines":"VC",Venezuela:"VE","British Virgin Islands":"VG","U.S. Virgin Islands":"VI",Vietnam:"VN",Vanuatu:"VU","Wallis and Futuna":"WF",Samoa:"WS",Yemen:"YE",Mayotte:"YT","South Africa":"ZA",Zambia:"ZM",Zimbabwe:"ZW","Serbia and Montenegro":"CS"},COUNTRIES:["Andorra","United Arab Emirates","Afghanistan","Antigua and Barbuda","Anguilla","Albania","Armenia","Angola","Antarctica","Argentina","American Samoa","Austria","Australia","Aruba","Aland Islands","Azerbaijan","Bosnia and Herzegovina","Barbados","Bangladesh","Belgium","Burkina Faso","Bulgaria","Bahrain","Burundi","Benin","Saint Barthelemy","Bermuda","Brunei","Bolivia","Bonaire","Brazil","Bahamas","Bhutan","Bouvet","Botswana","Belarus","Belize","Canada","Cocos Islands","Democratic Republic of the Congo","Central African Republic","Republic of the Congo","Switzerland","Ivory Coast","Cook Islands","Chile","Cameroon","China","Colombia","Costa Rica","Cuba","Cape Verde","Curacao","Christmas Island","Cyprus","Czech Republic","Germany","Djibouti","Denmark","Dominica","Dominican Republic","Algeria","Ecuador","Estonia","Egypt","Western Sahara","Eritrea","Spain","Ethiopia","Finland","Fiji","Falkland Islands","Micronesia","Faroe Islands","France","Gabon","United Kingdom","Grenada","Georgia","French Guiana","Guernsey","Ghana","Gibraltar","Greenland","Gambia","Guinea","Guadeloupe","Equatorial Guinea","Greece","South Georgia and the South Sandwich Islands","Guatemala","Guam","Guinea-Bissau","Guyana","Hong Kong","Heard Island and McDonald Islands","Honduras","Croatia","Haiti","Hungary","Indonesia","Ireland","Israel","Isle of Man","India","British Indian Ocean Territory","Iraq","Iran","Iceland","Italy","Jersey","Jamaica","Jordan","Japan","Kenya","Kyrgyzstan","Cambodia","Kiribati","Comoros","Saint Kitts and Nevis","North Korea","South Korea","Kosovo","Kuwait","Cayman Islands","Kazakhstan","Laos","Lebanon","Saint Lucia","Liechtenstein","Sri Lanka","Liberia","Lesotho","Lithuania","Luxembourg","Latvia","Libya","Morocco","Monaco","Moldova","Montenegro","Saint Martin","Madagascar","Marshall Islands","Macedonia","Mali","Myanmar","Mongolia","Macao","Northern Mariana Islands","Martinique","Mauritania","Montserrat","Malta","Mauritius","Maldives","Malawi","Mexico","Malaysia","Mozambique","Namibia","New Caledonia","Niger","Norfolk Island","Nigeria","Nicaragua","Netherlands","Norway","Nepal","Nauru","Niue","New Zealand","Oman","Panama","Peru","French Polynesia","Papua New Guinea","Philippines","Pakistan","Poland","Saint Pierre and Miquelon","Pitcairn","Puerto Rico","Palestinian Territory","Portugal","Palau","Paraguay","Qatar","Reunion","Romania","Serbia","Russia","Rwanda","Saudi Arabia","Solomon Islands","Seychelles","Sudan","South Sudan","Sweden","Singapore","Saint Helena","Slovenia","Svalbard","Slovakia","Sierra Leone","San Marino","Senegal","Somalia","Suriname","Sao Tome and Principe","El Salvador","Sint Maarten","Damascus","Swaziland","Turks and Caicos Islands","Chad","French Southern Territories","Togo","Thailand","Tajikistan","Tokelau","East Timor","Turkmenistan","Tunisia","Tonga","Turkey","Trinidad and Tobago","Tuvalu","Taiwan","Tanzania","Ukraine","Uganda","Northern Ireland","United States Minor Outlying Islands","United States","Uruguay","Uzbekistan","Vatican","Saint Vincent and the Grenadines","Venezuela","British Virgin Islands","U.S. Virgin Islands","Vietnam","Vanuatu","Wallis and Futuna","Samoa","Yemen","Mayotte","South Africa","Zambia","Zimbabwe","Serbia and Montenegro","USA","United States of America","Great Britain"],STATES:{AUSTRALIA:["ACT","NSW","NT","SA","TAS","QLD","VIC","WA"],CANADA:["AB","BC","MB","NB","NL","NS","ON","PE","QC","SK"],USA:["AL","AK","AS","AZ","CA","CO","CT","DE","DC","FM","FL","AR","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MH","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PW","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"]},CURRENCIES:["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYR","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","USS","UYI","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"],toType:function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},requestAnimationFrame:function(){var a;return a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)},function(e){return a.call(window,e)}}(),cookie:function(a,e){var n,t,i,r;if(!e){for(r=document.cookie.split(";"),t=0,i=r.length;i>t;t++)if(n=r[t],1===n.indexOf(a))return n.split("=")[1];return!1}return document.cookie=""+a+"="+e+"; path=/"},sha:function(){var a,e,n,t;for(n="",e="abcdefghijklmnopqrstuvwxyz0123456789",a=t=0;56>=t;a=++t)n+=e.charAt(Math.floor(Math.random()*e.length));return n},uuid:function(){var a;return a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},urlify:function(){return console.log("urlify")},queryfy:function(a){var e,n,t,i,r,o,s,u;for(i=[],u=a.split("+"),o=0,s=u.length;s>o;o++)n=u[o],n||(n="collection:/"),e=n.split(":"),t=e[0].toLowerCase(),r=decodeURIComponent(e[1]||""),e={},e[t]=r,i.push(e);return i},pluralize:function(a){return a+"s"},singularize:function(a){return a.replace(/s$/,"")},titleCase:function(a){return"string"!=typeof a?a:a.charAt(0).toUpperCase()+a.slice(1)},normalize:function(a){var e,n,t;return e={"ä":"ae","ö":"oe","ü":"ue","&":"and","é":"e","ë":"e","ï":"i","è":"e","à":"a","ù":"u","ç":"c","ø":"o"},a=a.toLowerCase(),n=new RegExp(Object.keys(e).join("|"),"g"),t=a.trim().replace(n,function(a){return e[a]}).toLowerCase(),t.replace(/[',:;#]/g,"").replace(/[^\/\w]+/g,"-").replace(/\W?\/\W?/g,"/").replace(/^-|-$/g,"")},alphaNumSort:a=function(a,e){var n,t,i,r,o,s;for(r=function(a){var e,n,t,i,r,o,s;for(r=[],o=0,s=-1,i=0,e=void 0,n=void 0;e=(n=a.charAt(o++)).charCodeAt(0);)t=46===e||e>=48&&57>=e,t!==i&&(r[++s]="",i=t),r[s]+=n;return r},n=r(a),t=r(e),s=0;n[s]&&t[s];){if(n[s]!==t[s])return i=Number(n[s]),o=Number(t[s]),i===n[s]&&o===t[s]?i-o:n[s]>t[s]?1:-1;s++}return n.length-t.length},isiOS:function(){return!!navigator.userAgent.match(/iPad|iPhone|iPod/i)},isiPad:function(){return!!navigator.userAgent.match(/iPad/i)},isiPhone:function(){return!!navigator.userAgent.match(/iPhone/i)},isiPod:function(){return!!navigator.userAgent.match(/iPod/i)},isChrome:function(){return!!navigator.userAgent.match(/Chrome/i)},isIE:function(){return!!navigator.userAgent.match(/MSIE/i)},isFirefox:function(){return!!navigator.userAgent.match(/Firefox/i)},isSafari:function(){return!!navigator.userAgent.match(/Safari/i)&&!this.isChrome()},isMobile:function(){return!!navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i)},isEven:function(a){return this.isNumber(a)&&a%2===0},isOdd:function(a){return this.isNumber(a)&&a%2===1},isNumber:function(a){return a===parseFloat(a)},toFloat:function(a,e){var n,t;if(null==e&&(e=2),!e)return a;for(a=String(a).replace(/\D/g,""),n=a.slice(a.length-e);n.length<e;)n="0"+n;return t=a.slice(0,a.length-e)||"0",""+t+"."+n},toPrice:function(a,e){var n,t;return n=this.toFloat(a).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),t=this.getCurrencySymbol(e),""+t+" "+n},isEmail:function(a){var e;return e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,!!a.match(e)},getAssetKind:function(a){var e;return 0===a.indexOf("Collection-")?e="collection":0===a.indexOf("Proxy-")?e="Proxy":0===a.indexOf("Order-")?e="Order":0===a.indexOf("Generic")?e="Generic":a.match(/[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}/)?e="image":a.match(/[0-9a-z]{56}/)&&(e="video"),e},getKeyName:function(a){return KEYS[a.which]},getURLParameter:function(a){var e,n;return a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=new RegExp("[\\?&]"+a+"=([^&#]*)"),n=e.exec(location.search),null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},inUsa:function(a){var e;return"usa"===(e=null!=a?a.toLowerCase():void 0)||"united states"===e||"united states of america"===e},replaceNewLines:function(a){return a.replace(/(\r\n\r\n|\r\n|\n|\r)/gm,"<br>")},getCurrencySymbol:function(a){return this.SYMBOLS[a]||this.SYMBOLS.GENERIC},getCurrency:function(a){return CURRENCY_MAPPING[a]},includesTax:function(a){var e;return e={USD:!1},void 0!==e[a]?!1:!0},toArray:function(a){return angular.isArray(a)?a:[a]},getMeta:function(a,e){return a.fields[e]?a.fields[e].value:console.log("This asset does not contain a "+e+" attribute")},isBaseString:function(a){return null==a&&(a=""),!!a.match(this.isBaseRegex)},isBaseRegex:/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,renameKey:function(a,e,n){return n[e]=n[a],delete n[a],n}}}return a}(),angular.module("imago").factory("imagoUtils",[imagoUtils]);var imagoWorker,__bind=function(a,e){return function(){return a.apply(e,arguments)}};imagoWorker=function(){function a(a){this.$q=a,this.work=__bind(this.work,this),this.create=__bind(this.create,this)}return a.prototype.create=function(a){return new Worker(a)},a.prototype.work=function(a){var e,n;return e=this.$q.defer(),a&&a.path||e.reject("nodata"),n=this.create(a.path),n.addEventListener("message",function(){return function(a){return e.resolve(a.data),n.terminate()}}(this)),n.postMessage(a),e.promise},a}(),angular.module("imago").service("imagoWorker",["$q",imagoWorker]);var Meta;Meta=function(){function a(){return function(a,e){return a&&e&&a.fields[e]?a.fields[e].value.type?a.fields[e].value.value:a.fields[e].value:void 0}}return a}(),angular.module("imago").filter("meta",[Meta]);var imagoPage;imagoPage=function(){function a(a,e,n){var t;t="/",n.getData(t).then(function(e){return a.collection=e[0],a.assets=n.getChildren(e[0])})}return a}(),angular.module("imago").controller("imagoPage",["$scope","$state","imagoModel",imagoPage]);
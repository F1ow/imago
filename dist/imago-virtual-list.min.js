var ImagoVirtualList;ImagoVirtualList=function(){function i(i){return{scope:{data:"="},templateUrl:"/app/tests/ui-virtual-list.html",link:function(i,e,t){var r,l;return r=454,l=350,i.height=500,i.width=e[0].clientWidth,i.scrollTop=0,i.visibleProvider=[],i.cellsPerPage=0,i.numberOfCells=0,i.canvasHeight={},i.init=function(){return e[0].addEventListener("scroll",i.onScroll),i.itemsPerRow=Math.round(i.width/l),i.cellsPerPage=Math.round(i.height/r)*i.itemsPerRow,i.numberOfCells=3*i.cellsPerPage,i.canvasHeight={height:Math.ceil(i.data.length*r/i.itemsPerRow)+"px"},i.updateDisplayList()},i.updateDisplayList=function(){var e,t,a,s,n,o,u,d,c;for(n=Math.max(Math.floor(i.scrollTop/r)-Math.round(i.height/r),0),e=Math.min(n+i.numberOfCells,i.numberOfCells),d=angular.copy(i.visibleProvider),a=n*i.itemsPerRow,i.visibleProvider=i.data.slice(a,a+e),t=_.chunk(i.visibleProvider,i.itemsPerRow),o=0,c=[];o<i.visibleProvider.length;)s=function(){var e,r,l,a,s,n,u,d,c;for(l=n=0,d=t.length;d>n;l=++n)for(e=t[l],a=u=0,c=e.length;c>u;a=++u)if(s=e[a],s._id===i.visibleProvider[o]._id)return r={chunk:l,inside:a}},u=s(),i.visibleProvider[o].styles={transform:"translate3d("+(l*u.inside+"px")+", "+((n+u.chunk)*r+"px")+", 0)"},c.push(o++);return c},i.onScroll=function(t){return i.scrollTop=e.prop("scrollTop"),i.updateDisplayList(),i.$apply()},i.$watch("data",function(e){return e?i.init():void 0})}}}return i}(),angular.module("imago").directive("imagoVirtualList",["$timeout",ImagoVirtualList]),angular.module("imago").run(["$templateCache",function(i){i.put("/imago/imago-virtual-list.html",'<div ng-style="canvasHeight" class="canvas"><div ng-repeat="item in visibleProvider" ng-style="item.styles" ui-sref="details({\'id\': item._id})" ng-class="item.type" class="renderer item"><div><div style="background-image: url({{item.serving_url}}=s480);" class="media"></div><div class="caption"><div class="source"><span>{{item.fields.source.value}}</span></div><h2><span>{{item.fields.title.value}}</span></h2><br/><h3><span>{{item.fields.description.value}}</span></h3></div></div></div></div>')}]);